apiVersion: v1
kind: ConfigMap
metadata:
  name: udp-director-config
  namespace: default
data:
  config.yaml: |
    # UDP Director Configuration - Agones GameServer
    # This example routes to Agones GameServer resources
    # Demonstrates both label and annotation filtering
    
    queryPort: 9000
    dataPort: 7777
    tokenTtlSeconds: 30
    sessionTimeoutSeconds: 300
    controlPacketMagicBytes: "FFFFFFFF5245534554"

    # Default endpoint - targets Agones GameServers
    defaultEndpoint:
      resourceType: "gameserver"
      namespace: "default"
      
      # Labels: Static configuration (server-side filtering)
      labelSelector:
        agones.dev/fleet: "my-fleet"
        map: "de_dust2"
      
      # Annotations: Dynamic operational data (client-side filtering)
      # Uncomment to filter by current player count or other dynamic values
      # annotationSelector:
      #   currentPlayers: "32"
      #   status: "available"
      
      # Status: Filter by resource status
      statusQuery:
        jsonPath: "status.state"
        expectedValues:
          - "Ready"
          - "Allocated"

    # Resource query mapping for Agones GameServers
    resourceQueryMapping:
      gameserver:
        group: "agones.dev"
        version: "v1"
        resource: "gameservers"
        # Use PodIP from addresses array (for portPolicy: None)
        addressPath: "status.addresses"
        addressType: "PodIP"
        portName: "default"
